RANDOMIZE TIMER
SCREEN 7, , 1, 0
e = 160
p = 2 * 3.14159265359#
g = 160
anz = 30
DIM x(anz, 4), y(anz, 4), z(anz, 4), c(anz), r(anz)
FOR i = 1 TO anz
 FOR t = 0 TO 4
  READ x(i, t), y(i, t), z(i, t)
  x(i, t) = x(i, t) * g '''- g * 2
  y(i, t) = y(i, t) * g
  z(i, t) = z(i, t) * g '''- g * 5
 NEXT t
 READ c(i)
NEXT i
xd = p: yd = p: zd = p
DO
 a1 = SIN(xd): a2 = COS(xd)
 b1 = SIN(yd): b2 = COS(yd)
 c1 = SIN(zd): c2 = COS(zd)
 FOR i = 1 TO anz
  FOR t = 0 TO 4
   yy = y(i, t) * a2 - z(i, t) * a1
   zz = y(i, t) * a1 + z(i, t) * a2
   y(i, t) = yy: z(i, t) = zz
   xx = x(i, t) * b2 - z(i, t) * b1
   zz = x(i, t) * b1 + z(i, t) * b2
   x(i, t) = xx: z(i, t) = zz
   xx = x(i, t) * c2 - y(i, t) * c1
   yy = x(i, t) * c1 + y(i, t) * c2
   x(i, t) = xx: y(i, t) = yy
  NEXT t
 NEXT i

 FOR i = 1 TO anz
  FOR t = 0 TO 4
   z(i, t) = z(i, t) - zs
  NEXT t
 NEXT i

 FOR t = 1 TO anz
  r(t) = t
 NEXT t
 FOR t = 1 TO anz
  FOR i = t + 1 TO anz
   IF z(r(t), 0) < z(r(i), 0) THEN SWAP r(t), r(i)
  NEXT i
 NEXT t
 CLS
 LINE (0, 0)-(319, 99), 9, BF
 LINE (0, 100)-(319, 199), 10, BF
 FOR t = 1 TO anz
  n = r(t)
  IF z(n, 0) - g / 2 > -e THEN
   x1 = 160 + x(n, 1) / (z(n, 1) + e) * e
   y1 = 100 + y(n, 1) / (z(n, 1) + e) * e
   x2 = 160 + x(n, 2) / (z(n, 2) + e) * e
   y2 = 100 + y(n, 2) / (z(n, 2) + e) * e
   x3 = 160 + x(n, 3) / (z(n, 3) + e) * e
   y3 = 100 + y(n, 3) / (z(n, 3) + e) * e
   x4 = 160 + x(n, 4) / (z(n, 4) + e) * e
   y4 = 100 + y(n, 4) / (z(n, 4) + e) * e
   x0 = 160 + x(n, 0) / (z(n, 0) + e) * e
   y0 = 100 + y(n, 0) / (z(n, 0) + e) * e
   LINE (x1, y1)-(x2, y2), c(n)
   LINE (x2, y2)-(x3, y3), c(n)
   LINE (x3, y3)-(x4, y4), c(n)
   LINE (x4, y4)-(x1, y1), c(n)
   PAINT (x0, y0), c(n), c(n)
  END IF
 NEXT t
 PCOPY 1, 0
 xd = 0: yd = 0: zd = 0: zs = 0
 DO: t$ = INKEY$: LOOP WHILE t$ = ""
 SELECT CASE t$
 CASE CHR$(0) + "H": zs = g / 4
 CASE CHR$(0) + "P": zs = -g / 4
 CASE CHR$(0) + "K": yd = p - p / 16
 CASE CHR$(0) + "M": yd = p / 16
 CASE CHR$(27): END
 END SELECT

 'xd = xd + RND * .04 - .02
 'IF xd < p - .15 THEN xd = p - .15
 'IF xd > p + .15 THEN xd = p + .15
 'yd = yd + RND * .04 - .02
 'IF yd < p - .15 THEN yd = p - .15
 'IF yd > p + .15 THEN yd = p + .15
 'zd = zd + RND * .04 - .02
 'IF zd < p - .15 THEN zd = p - .15
 'IF zd > p + .15 THEN zd = p + .15
LOOP UNTIL INKEY$ = CHR$(27)






DATA  -1,0,2.5, -1,-1, 2, -1,-1, 3, -1,1, 3, -1,1, 2, 1
DATA  -1,0,3.5, -1,-1, 3, -1,-1, 4, -1,1, 4, -1,1, 3, 1
DATA  -1,0,4.5, -1,-1, 4, -1,-1, 5, -1,1, 5, -1,1, 4, 1
DATA  -1,0,5.5, -1,-1, 5, -1,-1, 6, -1,1, 6, -1,1, 5, 1
DATA  -1,0,6.5, -1,-1, 6, -1,-1, 7, -1,1, 7, -1,1, 6, 1
DATA  -1,0,7.5, -1,-1, 7, -1,-1, 8, -1,1, 8, -1,1, 7, 1

DATA   5,0,2.5,  5,-1, 2,  5,-1, 3,  5,1, 3,  5,1, 2, 2
DATA   5,0,3.5,  5,-1, 3,  5,-1, 4,  5,1, 4,  5,1, 3, 2
DATA   5,0,4.5,  5,-1, 4,  5,-1, 5,  5,1, 5,  5,1, 4, 2
DATA   5,0,5.5,  5,-1, 5,  5,-1, 6,  5,1, 6,  5,1, 5, 2
DATA   5,0,6.5,  5,-1, 6,  5,-1, 7,  5,1, 7,  5,1, 6, 2
DATA   5,0,7.5,  5,-1, 7,  5,-1, 8,  5,1, 8,  5,1, 7, 2

DATA   1,0,6.5,  1,-1, 6,  1,-1, 7,  1,1, 7,  1,1, 6, 3
DATA   1,0,7.5,  1,-1, 7,  1,-1, 8,  1,1, 8,  1,1, 7, 3

DATA -0.5,0, 8, -1,-1, 8,  0,-1, 8,  0,1, 8, -1,1, 8, 4
DATA  0.5,0, 8,  0,-1, 8,  1,-1, 8,  1,1, 8,  0,1, 8, 4
DATA  1.5,0, 8,  1,-1, 8,  2,-1, 8,  2,1, 8,  1,1, 8, 4
DATA  2.5,0, 8,  2,-1, 8,  3,-1, 8,  3,1, 8,  2,1, 8, 4
DATA  3.5,0, 8,  3,-1, 8,  4,-1, 8,  4,1, 8,  3,1, 8, 4
DATA  4.5,0, 8,  4,-1, 8,  5,-1, 8,  5,1, 8,  4,1, 8, 4

DATA  1.5,0, 2,  1,-1, 2,  2,-1, 2,  2,1, 2,  1,1, 2, 5
DATA  2.5,0, 2,  2,-1, 2,  3,-1, 2,  3,1, 2,  2,1, 2, 5
DATA  3.5,0, 2,  3,-1, 2,  4,-1, 2,  4,1, 2,  3,1, 2, 5
DATA  4.5,0, 2,  4,-1, 2,  5,-1, 2,  5,1, 2,  4,1, 2, 5

DATA -0.5,0, 4, -1,-1, 4,  0,-1, 4,  0,1, 4, -1,1, 4, 6
DATA  0.5,0, 4,  0,-1, 4,  1,-1, 4,  1,1, 4,  0,1, 4, 6
DATA  1.5,0, 4,  1,-1, 4,  2,-1, 4,  2,1, 4,  1,1, 4, 6
DATA  2.5,0, 4,  2,-1, 4,  3,-1, 4,  3,1, 4,  2,1, 4, 6

DATA  3.5,0, 6,  3,-1, 6,  4,-1, 6,  4,1, 6,  3,1, 6, 7
DATA  4.5,0, 6,  4,-1, 6,  5,-1, 6,  5,1, 6,  4,1, 6, 7




DATA  5, 0, 7,  5,-1, 6,  5,-1, 8,  5, 1, 8,  5, 1, 6, 3
DATA  5, 0, 5,  5,-1, 4,  5,-1, 6,  5, 1, 6,  5, 1, 4, 3
DATA  5, 0, 3,  5,-1, 2,  5,-1, 4,  5, 1, 4,  5, 1, 2, 3

DATA  4, 0, 2,  3,-1, 2,  5,-1, 2,  5, 1, 2,  3, 1, 2, 4
DATA  2, 0, 2,  1,-1, 2,  3,-1, 2,  3, 1, 2,  1, 1, 2, 4

DATA  0, 0, 4, -1,-1, 4,  1,-1, 4,  1, 1, 4, -1, 1, 4, 5
DATA  2, 0, 4,  1,-1, 4,  3,-1, 4,  3, 1, 4,  1, 1, 4, 5

DATA  2, 0, 6,  1,-1, 6,  3,-1, 6,  3, 1, 6,  1, 1, 6, 6

DATA  1, 0, 7,  1,-1, 6,  1,-1, 8,  1, 1, 8,  1, 1, 6, 7

